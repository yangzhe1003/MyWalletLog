import{r as b,j as s}from"./index-f2e19821.js";import{a as H,F as k,b as W,I as N,T as P,S as u,c as q,C as $,B as F,D as ee,L as te,e as se,n as T,E as ae,d as le}from"./save_excel-2e50c88f.js";const K={bsc:"https://api.bscscan.com",ftm:"https://api.ftmscan.com",metis:"https://andromeda-explorer.metis.io",avax:"https://api.snowtrace.io",matic:"https://api.polygonscan.com",arb:"https://api.arbiscan.io",op:"https://api-optimistic.etherscan.io",eth:"https://api.etherscan.io"},re={bsc:"IHA6XUNGC9A8CS1EVB4ZKMMNCEVWQYWGNF",ftm:"7NS7WM87WNYTDWXFRUP1QFVEGEMEWWTT1R",metis:null,avax:"XZVMR1A53KHXIEZV2X5QYZ2GSYFDDHUGVS",matic:"5N7B38PZTENUK44XDF3WUPFFN68ICZ87Y3",arb:"FTAT7G2F45P8VNVQG66SGF7T4TS6R2QFGY",op:"C8JSVBMBI2NBBYWUJ99ZR2QCQ8GB33NFGB",eth:"FPFT5EGK6F4JS97IA4E8SI24UN559W53VI"};let D={};async function M(n){const i=Object.keys(K).map(async c=>{try{const o=K[c],g=re[c];let C=0;n=n.toLowerCase();const V=`${o}/api?module=account&action=txlist&address=${n}&startblock=0&endblock=99999999&page=1&offset=10000&sort=asc&apikey=${g}`,S=await H.get(V);for(let I=0;I<S.data.result.length;I++){const w=S.data.result[I].input.slice(0,10);S.data.result[I].from===n&&S.data.result[I].txreceipt_status==="1"&&["0x9fbf10fc","0x1114cd2a","0x76a9099a","0x2e15238c","0xae30f6ee","0xc45dec27","0x2cdf0b95","0x879762e2","0x656f3d64","0x51905636","0xad660825","0xfe359a0d","0xca23bb4c"].includes(w)&&(C+=1)}return{net:c,tx:C}}catch(o){return console.log(o.message),{net:c,tx:"error"}}}),v=await Promise.all(i);let E=0;return v.forEach(({net:c,tx:o})=>{o!=="error"&&(E+=o),D[c]=o}),D.total=E,D}const{Content:ne}=te,{TextArea:ie}=N,ce=()=>{const[n,i]=b.useState([]),[v,E]=b.useState(!1),[c]=k.useForm(),[o]=k.useForm(),[g,C]=b.useState([]),[V,S]=b.useState(!1),[I,w]=b.useState(!1),[A,G]=b.useState(!1),R={onChange:(e,a)=>{C(e)}},_=()=>{se(n,"LayerZeroInfo")},L=()=>{i(n.filter(e=>!g.includes(e.key))),localStorage.setItem("l0_addresses",JSON.stringify(n.filter(e=>!g.includes(e.key)))),C([])},z=e=>{i(n.filter(a=>a.key!==e)),localStorage.setItem("l0_addresses",JSON.stringify(n.filter(a=>a.key!==e)))},Z=async()=>{try{const e=await c.validateFields();if(e.address.startsWith("0x")||(e.address="0x"+e.address),e.address.length!==42){T.error({message:"错误",description:"请输入正确的EVM地址"},2);return}E(!1);const a=n.findIndex(l=>l.address===e.address);if(a!==-1){i(n.map((t,d)=>d===a?{...t,name:e.name}:t));const l=[...n];M(e.address).then(({arb:t,avax:d,bsc:r,eth:m,ftm:x,matic:h,metis:p,op:f,total:y})=>{l[a]={...l[a],arb:t,avax:d,bsc:r,eth:m,ftm:x,matic:h,metis:p,op:f,total:y},i(l),localStorage.setItem("l0_addresses",JSON.stringify(n))})}else{const l={key:n.length.toString(),name:e.name,address:e.address,arb:null,avax:null,bsc:null,eth:null,ftm:null,matic:null,metis:null,op:null,total:null},t=[...n,l];i(t),M(e.address).then(({arb:d,avax:r,bsc:m,eth:x,ftm:h,matic:p,metis:f,op:y,total:j})=>{l.arb=d,l.avax=r,l.bsc=m,l.eth=x,l.ftm=h,l.matic=p,l.metis=f,l.op=y,l.total=j,i([...t]),localStorage.setItem("l0_addresses",JSON.stringify(t))})}}catch(e){T.error({message:"错误",description:e.message},2)}finally{c.resetFields()}},Q=async()=>{if(!g.length){T.error({message:"错误",description:"请先选择要刷新的地址"},2);return}S(!0);try{const e=[...n];for(let a of g){const l=e.findIndex(t=>t.key===a);if(l!==-1){const t=e[l];t.eth=null,t.bsc=null,t.ftm=null,t.matic=null,t.metis=null,t.op=null,t.arb=null,t.avax=null,t.total=null,i([...e]),M(t.address).then(({arb:d,avax:r,bsc:m,eth:x,ftm:h,matic:p,metis:f,op:y,total:j})=>{t.arb=d,t.avax=r,t.bsc=m,t.eth=x,t.ftm=h,t.matic=p,t.metis=f,t.op=y,t.total=j,i([...e]),localStorage.setItem("l0_addresses",JSON.stringify(n))})}}}catch(e){T.error({message:"错误",description:e.message},2)}finally{S(!1)}},U=async()=>{try{const a=(await o.validateFields()).addresses.split(`
`),l=[...n];for(let t of a){if(t.startsWith("0x")||(t="0x"+t),t=t.trim(),t.length!==42){T.error({message:"错误",description:"请输入正确的EVM地址"});continue}const d=l.findIndex(r=>r.address===t);if(d!==-1){const r=[...l];M(t).then(({arb:m,avax:x,bsc:h,eth:p,ftm:f,matic:y,metis:j,op:O,total:B})=>{r[d]={...r[d],arb:m,avax:x,bsc:h,eth:p,ftm:f,matic:y,metis:j,op:O,total:B},i(r),localStorage.setItem("l0_addresses",JSON.stringify(r))})}else{const r={key:l.length.toString(),address:t,arb:null,avax:null,bsc:null,eth:null,ftm:null,matic:null,metis:null,op:null,total:null};l.push(r),i(l),M(t).then(({arb:m,avax:x,bsc:h,eth:p,ftm:f,matic:y,metis:j,op:O,total:B})=>{r.arb=m,r.avax=x,r.bsc=h,r.eth=p,r.ftm=f,r.matic=y,r.metis=j,r.op=O,r.total=B,i([...l]),localStorage.setItem("l0_addresses",JSON.stringify(l))})}}w(!1)}catch(e){T.error({message:"错误",description:e.message})}finally{o.resetFields()}},[X,J]=b.useState(null),Y=[{title:"备注",dataIndex:"name",key:"name",align:"center",render:(e,a)=>a.key===X?s.jsx(N,{placeholder:"请输入备注",defaultValue:e,onPressEnter:t=>{a.name=t.target.value,i([...n]),localStorage.setItem("l0_addresses",JSON.stringify(n)),J(null)}}):s.jsxs(s.Fragment,{children:[s.jsx(P,{color:"blue",children:e}),s.jsx(F,{shape:"circle",icon:s.jsx(ae,{}),size:"small",onClick:()=>J(a.key)})]})},{title:"地址",dataIndex:"address",key:"address",align:"center"},{title:"ETH",dataIndex:"eth",key:"eth",render:(e,a)=>e===null?s.jsx(u,{}):e,align:"center"},{title:"MATIC",dataIndex:"matic",key:"matic",render:(e,a)=>e===null?s.jsx(u,{}):e,align:"center"},{title:"BSC",dataIndex:"bsc",key:"bsc",render:(e,a)=>e===null?s.jsx(u,{}):e,align:"center"},{title:"ARB",dataIndex:"arb",key:"arb",render:(e,a)=>e===null?s.jsx(u,{}):e,align:"center"},{title:"OP",dataIndex:"op",key:"op",render:(e,a)=>e===null?s.jsx(u,{}):e,align:"center"},{title:"AVAX",dataIndex:"avax",key:"avax",render:(e,a)=>e===null?s.jsx(u,{}):e,align:"center"},{title:"FTM",dataIndex:"ftm",key:"ftm",render:(e,a)=>e===null?s.jsx(u,{}):e,align:"center"},{title:"METIS",dataIndex:"metis",key:"metis",render:(e,a)=>e===null?s.jsx(u,{}):e,align:"center"},{title:"总Tx",dataIndex:"total",key:"total",render:(e,a)=>e===null?s.jsx(u,{}):e,align:"center"},{title:"操作",key:"action",render:(e,a)=>s.jsx(le,{size:"small",children:s.jsx(F,{type:"primary",danger:!0,onClick:()=>z(a.key),children:"删除"})}),align:"center"}];return b.useEffect(()=>{G(!0);const e=localStorage.getItem("l0_addresses");setTimeout(()=>{G(!1)},500),e&&i(JSON.parse(e))},[]),s.jsx("div",{children:s.jsxs(ne,{children:[s.jsx(W,{title:"批量添加地址",open:I,onOk:U,onCancel:()=>{w(!1),o.resetFields()},okText:"添加地址",cancelText:"取消",children:s.jsx(k,{form:o,layout:"vertical",children:s.jsx(k.Item,{label:"地址",name:"addresses",rules:[{required:!0}],children:s.jsx(ie,{placeholder:"请输入地址，每行一个",style:{width:"500px",height:"200px"}})})})}),s.jsx(W,{title:"添加地址",open:v,onOk:Z,onCancel:()=>E(!1),okText:"添加地址",cancelText:"取消",children:s.jsxs(k,{form:c,layout:"vertical",children:[s.jsx(k.Item,{label:"地址",name:"address",rules:[{required:!0}],children:s.jsx(N,{placeholder:"请输入地址"})}),s.jsx(k.Item,{label:"备注",name:"name",rules:[{required:!0}],children:s.jsx(N,{placeholder:"请输入备注"})})]})}),s.jsx(P,{color:"blue",style:{marginBottom:"10px"},children:"获取数据使用的是作者的区块链浏览器API Key，用的人多可能会有卡顿报错的情况，如果有需要请自行申请API Key，并在Github Clone并修改代码"}),s.jsx(u,{spinning:A,children:s.jsx(q,{columns:Y,dataSource:n,rowSelection:{type:"checkbox",...R},pagination:!1,bordered:!0,size:"small"})}),s.jsx($,{children:s.jsxs("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"},children:[s.jsx(F,{type:"primary",onClick:()=>{E(!0)},size:"large",style:{width:"20%"},children:"添加地址"}),s.jsx(F,{type:"primary",onClick:()=>{w(!0)},size:"large",style:{width:"20%"},children:"批量添加地址"}),s.jsx(F,{type:"primary",onClick:Q,loading:V,size:"large",style:{width:"20%"},disabled:!g.length,children:"刷新选中地址"}),s.jsx(F,{type:"primary",danger:!0,onClick:L,size:"large",style:{width:"20%"},disabled:!g.length,children:"删除选中地址"}),s.jsx(F,{type:"primary",icon:s.jsx(ee,{}),size:"large",style:{width:"8%"},onClick:_})]})})]})})};export{ce as default};
